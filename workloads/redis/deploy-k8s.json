{
  "name": "redis",
  "region": "us-east-1",
  "allowedPorts": [
    8080,
    8083,
    8086,
    7777,
    7778,
    8089,
    5000,
    6379,
    6001,
    2379,
    2380,
    4001
  ],
  "nodeMapping": [
    {
      "task": "redis-serve",
      "id": 1
    },
    {
      "task": "monitor",
      "id": 2
    },
    {
      "task": "snap",
      "id": 1
    },
    {
      "task": "redis-bench",
      "id": 2
    }
  ],
  "clusterDefinition": {
    "nodes": [
      {
        "instanceType": "t2.medium",
        "id": 1
      },
      {
        "instanceType": "t2.medium",
        "id": 2
      }
    ]
  },
  "ecs": {
    "taskDefinitions": [
      {
        "volumes": [
          {
            "host": {
              "sourcePath": "/"
            },
            "name": "root"
          },
          {
            "host": {
              "sourcePath": "/var/run"
            },
            "name": "var_run"
          },
          {
            "host": {
              "sourcePath": "/var/log"
            },
            "name": "var_log"
          },
          {
            "host": {
              "sourcePath": "/sys"
            },
            "name": "sys"
          },
          {
            "host": {
              "sourcePath": "/var/lib/docker/"
            },
            "name": "var_lib_docker"
          },
          {
            "host": {
              "sourcePath": "/cgroup"
            },
            "name": "cgroup"
          }
        ],
        "containerDefinitions": [
          {
            "mountPoints": [
              {
                "readOnly": true,
                "containerPath": "/rootfs",
                "sourceVolume": "root"
              },
              {
                "readOnly": false,
                "containerPath": "/var/run",
                "sourceVolume": "var_run"
              },
              {
                "readOnly": false,
                "containerPath": "/var/log",
                "sourceVolume": "var_log"
              },
              {
                "readOnly": true,
                "containerPath": "/sys",
                "sourceVolume": "sys"
              },
              {
                "readOnly": true,
                "containerPath": "/sys/fs/cgroup",
                "sourceVolume": "cgroup"
              },
              {
                "readOnly": true,
                "containerPath": "/var/lib/docker",
                "sourceVolume": "var_lib_docker"
              }
            ],
            "essential": true,
            "memory": 200,
            "cpu": 128,
            "image": "wen777/snap:alpine",
            "name": "snap"
          }
        ],
        "family": "snap"
      },
      {
        "containerDefinitions": [
          {
            "environment": [
              {
                "value": "snap",
                "name": "PRE_CREATE_DB"
              },
              {
                "value": "root",
                "name": "ADMIN_USER"
              },
              {
                "value": "hyperpilot",
                "name": "INFLUXDB_INIT_PWD"
              }
            ],
            "essential": true,
            "portMappings": [
              {
                "hostPort": 8083,
                "containerPort": 8083
              },
              {
                "hostPort": 8086,
                "containerPort": 8086
              }
            ],
            "memory": 300,
            "cpu": 512,
            "image": "tutum/influxdb",
            "name": "influxsrv"
          },
          {
            "environment": [
              {
                "value": "localhost",
                "name": "INFLUXDB_HOST"
              },
              {
                "value": "8086",
                "name": "INFLUXDB_PORT"
              },
              {
                "value": "snap",
                "name": "INFLUXDB_NAME"
              },
              {
                "value": "grafana-clock-panel,grafana-piechart-panel",
                "name": "GF_INSTALL_PLUGINS"
              },
              {
                "value": "root",
                "name": "INFLUXDB_USER"
              },
              {
                "value": "hyperpilot",
                "name": "INFLUXDB_PASS"
              }
            ],
            "links": [
              "influxsrv"
            ],
            "essential": true,
            "portMappings": [
              {
                "hostPort": 3000,
                "containerPort": 3000
              }
            ],
            "memory": 300,
            "cpu": 512,
            "image": "grafana/grafana",
            "name": "grafana"
          }
        ],
        "family": "monitor"
      },
      {
        "volumes": [
          {
            "host": {
              "sourcePath": "/var/run/docker.sock"
            },
            "name": "docker_sock"
          }
        ],
        "containerDefinitions": [
          {
            "portMappings": [
              {
                "hostPort": 6379,
                "containerPort": 6379
              }
            ],
            "essential": true,
            "memory": 100,
            "cpu": 512,
            "image": "redis:3.2.6",
            "name": "redis-serve"
          },
          {
            "mountPoints": [
              {
                "containerPath": "/var/run/docker.sock",
                "sourceVolume": "docker_sock"
              }
            ],
            "portMappings": [
              {
                "hostPort": 7778,
                "containerPort": 7778
              }
            ],
            "essential": true,
            "memory": 50,
            "cpu": 128,
            "image": "hyperpilot/benchmark-agent",
            "name": "benchmark-agent"
          }
        ],
        "family": "redis-serve"
      },
      {
        "containerDefinitions": [
          {
            "essential": true,
            "portMappings": [
              {
                "hostPort": 6001,
                "containerPort": 6001
              }
            ],
            "memory": 150,
            "cpu": 128,
            "image": "hyperpilot/redis-bench",
            "name": "redis-bench"
          }
        ],
        "family": "redis-bench"
      }
    ]
  },
  "kubernetes": {
    "taskDefinitions": [
      {
        "deployment": {
          "apiVersion": "extensions/v1beta1",
          "kind": "Deployment",
          "metadata": {
            "labels": {
              "app": "snap",
              "version": "latest"
            },
            "name": "snap",
            "namespace": "default"
          },
          "spec": {
            "replicas": 1,
            "selector": {
              "matchLabels": {
                "app": "snap",
                "version": "latest"
              }
            },
            "template": {
              "metadata": {
                "labels": {
                  "app": "snap",
                  "version": "latest"
                }
              },
              "spec": {
                "containers": [
                  {
                    "image": "wen777/snap:alpine",
                    "name": "snap",
                    "resources": {
                      "limits": {
                        "cpu": "125.0m",
                        "memory": "200Mi"
                      }
                    },
                    "volumeMounts": [
                      {
                        "mountPath": "/rootfs",
                        "name": "root"
                      },
                      {
                        "mountPath": "/var/run",
                        "name": "var-run"
                      },
                      {
                        "mountPath": "/var/log",
                        "name": "var-log"
                      },
                      {
                        "mountPath": "/sys",
                        "name": "sys"
                      },
                      {
                        "mountPath": "/sys/fs/cgroup",
                        "name": "cgroup"
                      },
                      {
                        "mountPath": "/var/lib/docker",
                        "name": "var-lib-docker"
                      }
                    ]
                  }
                ],
                "volumes": [
                  {
                    "hostPath": {
                      "path": "/"
                    },
                    "name": "root"
                  },
                  {
                    "hostPath": {
                      "path": "/cgroup"
                    },
                    "name": "cgroup"
                  },
                  {
                    "hostPath": {
                      "path": "/sys"
                    },
                    "name": "sys"
                  },
                  {
                    "hostPath": {
                      "path": "/var/lib/docker/"
                    },
                    "name": "var-lib-docker"
                  },
                  {
                    "hostPath": {
                      "path": "/var/log"
                    },
                    "name": "var-log"
                  },
                  {
                    "hostPath": {
                      "path": "/var/run"
                    },
                    "name": "var-run"
                  }
                ]
              }
            }
          }
        },
        "family": "snap"
      },
      {
        "deployment": {
          "apiVersion": "extensions/v1beta1",
          "kind": "Deployment",
          "metadata": {
            "labels": {
              "app": "influxsrv",
              "version": "latest"
            },
            "name": "influxsrv",
            "namespace": "default"
          },
          "spec": {
            "replicas": 1,
            "selector": {
              "matchLabels": {
                "app": "influxsrv",
                "version": "latest"
              }
            },
            "template": {
              "metadata": {
                "labels": {
                  "app": "influxsrv",
                  "version": "latest"
                }
              },
              "spec": {
                "containers": [
                  {
                    "env": [
                      {
                        "name": "INFLUXDB_NAME",
                        "value": "snap"
                      },
                      {
                        "name": "INFLUXDB_HOST",
                        "value": "localhost"
                      },
                      {
                        "name": "INFLUXDB_PORT",
                        "value": "8086"
                      },
                      {
                        "name": "INFLUXDB_USER",
                        "value": "root"
                      },
                      {
                        "name": "INFLUXDB_PASS",
                        "value": "hyperpilot"
                      },
                      {
                        "name": "GF_INSTALL_PLUGINS",
                        "value": "grafana-clock-panel,grafana-piechart-panel"
                      }
                    ],
                    "image": "grafana/grafana",
                    "name": "grafana",
                    "ports": [
                      {
                        "containerPort": 3000,
                        "hostPort": 3000,
                        "protocol": "TCP"
                      }
                    ],
                    "resources": {
                      "limits": {
                        "cpu": "500.0m",
                        "memory": "300Mi"
                      }
                    }
                  },
                  {
                    "env": [
                      {
                        "name": "ADMIN_USER",
                        "value": "root"
                      },
                      {
                        "name": "PRE_CREATE_DB",
                        "value": "snap"
                      },
                      {
                        "name": "INFLUXDB_INIT_PWD",
                        "value": "hyperpilot"
                      }
                    ],
                    "image": "tutum/influxdb",
                    "name": "influxsrv",
                    "ports": [
                      {
                        "containerPort": 8083,
                        "hostPort": 8083,
                        "protocol": "TCP"
                      },
                      {
                        "containerPort": 8086,
                        "hostPort": 8086,
                        "protocol": "TCP"
                      }
                    ],
                    "resources": {
                      "limits": {
                        "cpu": "500.0m",
                        "memory": "300Mi"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "family": "monitor"
      },
      {
        "deployment": {
          "apiVersion": "extensions/v1beta1",
          "kind": "Deployment",
          "metadata": {
            "labels": {
              "app": "redis-serve",
              "version": "latest"
            },
            "name": "redis-serve",
            "namespace": "default"
          },
          "spec": {
            "replicas": 1,
            "selector": {
              "matchLabels": {
                "app": "redis-serve",
                "version": "latest"
              }
            },
            "template": {
              "metadata": {
                "labels": {
                  "app": "redis-serve",
                  "version": "latest"
                }
              },
              "spec": {
                "containers": [
                  {
                    "image": "hyperpilot/benchmark-agent",
                    "name": "benchmark-agent",
                    "ports": [
                      {
                        "containerPort": 7778,
                        "hostPort": 7778,
                        "protocol": "TCP"
                      }
                    ],
                    "resources": {
                      "limits": {
                        "cpu": "125.0m",
                        "memory": "50Mi"
                      }
                    },
                    "volumeMounts": [
                      {
                        "mountPath": "/var/run/docker.sock",
                        "name": "docker-sock"
                      }
                    ]
                  },
                  {
                    "image": "redis:3.2.6",
                    "name": "redis-serve",
                    "ports": [
                      {
                        "containerPort": 6379,
                        "hostPort": 6379,
                        "protocol": "TCP"
                      }
                    ],
                    "resources": {
                      "limits": {
                        "cpu": "500.0m",
                        "memory": "100Mi"
                      }
                    }
                  }
                ],
                "volumes": [
                  {
                    "hostPath": {
                      "path": "/var/run/docker.sock"
                    },
                    "name": "docker-sock"
                  }
                ]
              }
            }
          }
        },
        "family": "redis-serve"
      },
      {
        "deployment": {
          "apiVersion": "extensions/v1beta1",
          "kind": "Deployment",
          "metadata": {
            "labels": {
              "app": "redis-bench",
              "version": "latest"
            },
            "name": "redis-bench",
            "namespace": "default"
          },
          "spec": {
            "replicas": 1,
            "selector": {
              "matchLabels": {
                "app": "redis-bench",
                "version": "latest"
              }
            },
            "template": {
              "metadata": {
                "labels": {
                  "app": "redis-bench",
                  "version": "latest"
                }
              },
              "spec": {
                "containers": [
                  {
                    "image": "hyperpilot/redis-bench",
                    "name": "redis-bench",
                    "ports": [
                      {
                        "containerPort": 6001,
                        "hostPort": 6001,
                        "protocol": "TCP"
                      }
                    ],
                    "resources": {
                      "limits": {
                        "cpu": "125.0m",
                        "memory": "150Mi"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "family": "redis-bench"
      }
    ]
  }
}
